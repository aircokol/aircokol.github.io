(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[3],{"554a":function(e,t,r){"use strict";var i=r("ca26"),n=r.n(i);n.a},ca26:function(e,t,r){},f68e:function(e,t,r){"use strict";r.r(t);var i=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("q-page",{staticClass:"q-pa-md"},[r("q-item",{staticClass:"q-px-none q-pt-none"},[r("q-list",{staticClass:"full-width cart-items-list"},[r("q-expansion-item",{attrs:{label:"Корзина",group:"cart-group",icon:"shopping_cart","default-opened":"","header-class":"bg-grey-2 text-secondary"}},[r("q-card",[r("q-card-section",{staticClass:"q-pa-none"},[e.loading?[r("q-item",{staticClass:"full-width justify-center"},[r("q-spinner-dots",{attrs:{color:"secondary",size:"3em"}})],1)]:[e.sets.length>0?[r("q-item-label",{attrs:{header:""}},[e._v("Комплекты")]),e._l(e.sets,(function(t){return r("q-item",{key:t.id,staticClass:"q-pr-none"},[r("q-item-section",{staticClass:"q-ml-none",attrs:{thumbnail:"",top:""}},[e._l(t.items,(function(e,t){return[r("div",{staticClass:"column"},[r("div",{staticClass:"col"},[r("img",{key:e.id,staticStyle:{"max-width":"60px","max-height":"40px"},attrs:{src:e.relative_image_path_list,alt:e.title,ratio:1.5}})])])]}))],2),r("q-item-section",{staticClass:"justify-between"},[r("q-item-label",[e._v("Комплект")]),r("q-item-label",{attrs:{caption:"",lines:"2"},domProps:{innerHTML:e._s(t.title)}}),r("q-item",{staticClass:"q-px-none q-pb-none"},[r("q-item-section",[r("q-item-label",[r("span",{staticClass:"text-body1 text-black"},[e._v(e._s(e._f("price_format")(t.price)))])])],1)],1)],1),r("q-item-section",{staticClass:"justify-between",attrs:{side:""}},[r("q-btn",{staticClass:"q-mb-sm",attrs:{icon:"close",size:"sm",dense:"","text-color":"red-5",color:"red-2",unelevated:"",loading:e.deleting,disable:e.deleting},on:{click:function(r){return e.deleteCartItem(t.items[0])}}}),r("q-select",{attrs:{filled:"",dense:"","options-dense":"",options:e.quantityItems,behavior:"menu",value:t.quantity,disable:e.updatingQuantity,loading:e.updatingQuantity},on:{input:function(r){return e.updateCartItemQuantity(t.items[0].id,r)}}})],1)],1)})),r("q-separator")]:e._e(),e.showCombineToComplectHeader?r("q-item",{staticClass:"bg-orange-2 text-orange-9 text-caption"},[r("q-item-section",{attrs:{avatar:""}},[r("q-icon",{attrs:{color:"accent",name:"info"}})],1),e._v("\n                Вы можете собрать в комплект Гарниры и Мясные блюда\n              ")],1):e._e(),e._l(e.cart.cart_items,(function(t,i){return r("q-item",{key:t.id,staticClass:"q-pr-none"},[r("q-item-section",{staticClass:"q-ml-none",attrs:{top:"",thumbnail:""}},[r("img",{attrs:{src:t.dish.relative_image_path_list}})]),r("q-item-section",{staticClass:"justify-between"},[r("q-item-label",[e._v(e._s(t.title))]),r("q-item",{staticClass:"q-px-none q-pb-none"},[r("q-item-section",[r("q-item-label",[r("span",{staticClass:"text-body1 text-black"},[e._v(e._s(e._f("price_format")(t.price)))])])],1),r("q-space"),t.for_complect&&1===t.quantity&&e.showCombineToComplectHeader?r("q-item-section",{attrs:{side:"",top:""}},[r("q-checkbox",{attrs:{label:"В Комплект","keep-color":"",color:"orange",val:t},model:{value:e.markedForSet,callback:function(t){e.markedForSet=t},expression:"markedForSet"}})],1):e._e()],1)],1),r("q-item-section",{staticClass:"justify-between",attrs:{side:""}},[r("q-btn",{staticClass:"q-mb-sm",attrs:{icon:"close",size:"sm",dense:"","text-color":"red-5",color:"red-2",unelevated:"",loading:e.deleting,disable:e.deleting},on:{click:function(r){return e.deleteCartItem(t)}}}),r("q-select",{attrs:{filled:"",dense:"","options-dense":"",options:e.quantityItems,behavior:"menu",value:t.quantity,disable:e.updatingQuantity,loading:e.updatingQuantity},on:{input:function(r){return e.updateCartItemQuantity(t.id,r)}}})],1)],1)}))]],2)],1)],1),r("q-separator"),r("q-expansion-item",{attrs:{label:"Информация о доставке",group:"cart-group",icon:"local_shipping","header-class":"bg-grey-2 text-secondary"}},[r("q-form",{ref:"form",staticClass:"q-gutter-sm",on:{submit:e.createOrder}},[r("q-toggle",{staticClass:"q-mb-sm q-mt-lg",attrs:{label:"Забрать из ресторана","true-value":"pickup","false-value":"shipping"},model:{value:e.order.delivery_type,callback:function(t){e.$set(e.order,"delivery_type",t)},expression:"order.delivery_type"}}),"shipping"===e.order.delivery_type?r("q-select",{attrs:{label:"Город *",outlined:"",dense:"",options:e.cities,"option-label":"name","options-dense":"",rules:[function(t){return"pickup"===e.order.delivery_type||!!t||"Обязательное поле"}]},model:{value:e.deliveryCity,callback:function(t){e.deliveryCity=t},expression:"deliveryCity"}}):e._e(),"shipping"===e.order.delivery_type?r("kl-street-select",{attrs:{label:"Улица *",city:e.deliveryCity,rules:[function(t){return"pickup"===e.order.delivery_type||!!t||"Обязательное поле"}]},model:{value:e.deliveryStreet,callback:function(t){e.deliveryStreet=t},expression:"deliveryStreet"}}):e._e(),"shipping"===e.order.delivery_type?r("q-input",{attrs:{label:"Дом *",outlined:"",dense:"",rules:[function(t){return"pickup"===e.order.delivery_type||!!t||"Обязательное поле"}]},model:{value:e.deliveryBuilding,callback:function(t){e.deliveryBuilding=t},expression:"deliveryBuilding"}}):e._e(),"shipping"===e.order.delivery_type?r("q-btn-toggle",{staticClass:"q-mb-lg",attrs:{spread:"","no-caps":"",unelevated:"","toggle-color":"primary",options:[{label:"Офис",value:"office"},{label:"Квартира",value:"room"}]},model:{value:e.order.delivery_office_or_room,callback:function(t){e.$set(e.order,"delivery_office_or_room",t)},expression:"order.delivery_office_or_room"}}):e._e(),"shipping"===e.order.delivery_type&&"office"===e.order.delivery_office_or_room?r("q-input",{attrs:{label:"Название фирмы *",outlined:"",dense:"",rules:[function(t){return"pickup"===e.order.delivery_type&&"office"===e.order.delivery_office_or_room||!!t||"Обязательное поле"}]},model:{value:e.order.delivery_office_firm_name,callback:function(t){e.$set(e.order,"delivery_office_firm_name",t)},expression:"order.delivery_office_firm_name"}}):e._e(),"shipping"===e.order.delivery_type&&"office"===e.order.delivery_office_or_room?r("q-input",{staticClass:"q-mb-lg",attrs:{label:"Этаж офиса",outlined:"",dense:""},model:{value:e.order.delivery_office_floor,callback:function(t){e.$set(e.order,"delivery_office_floor",t)},expression:"order.delivery_office_floor"}}):e._e(),"shipping"===e.order.delivery_type&&"office"===e.order.delivery_office_or_room?r("q-input",{attrs:{label:"Номер офиса",outlined:"",dense:""},model:{value:e.order.delivery_office_number,callback:function(t){e.$set(e.order,"delivery_office_number",t)},expression:"order.delivery_office_number"}}):e._e(),"shipping"===e.order.delivery_type&&"room"===e.order.delivery_office_or_room?r("q-input",{attrs:{label:"Квартира *",outlined:"",dense:"",rules:[function(t){return"pickup"===e.order.delivery_type&&"room"===e.order.delivery_office_or_room||!!t||"Обязательное поле"}]},model:{value:e.order.delivery_room_number,callback:function(t){e.$set(e.order,"delivery_room_number",t)},expression:"order.delivery_room_number"}}):e._e(),"shipping"===e.order.delivery_type&&"room"===e.order.delivery_office_or_room?r("q-input",{attrs:{label:"Подъезд *",outlined:"",dense:"",rules:[function(t){return"pickup"===e.order.delivery_type&&"room"===e.order.delivery_office_or_room||!!t||"Обязательное поле"}]},model:{value:e.order.delivery_room_entrance,callback:function(t){e.$set(e.order,"delivery_room_entrance",t)},expression:"order.delivery_room_entrance"}}):e._e(),"shipping"===e.order.delivery_type&&"room"===e.order.delivery_office_or_room?r("q-input",{attrs:{label:"Этаж *",outlined:"",dense:"",rules:[function(t){return"pickup"===e.order.delivery_type&&"room"===e.order.delivery_office_or_room||!!t||"Обязательное поле"}]},model:{value:e.order.delivery_room_floor,callback:function(t){e.$set(e.order,"delivery_room_floor",t)},expression:"order.delivery_room_floor"}}):e._e(),"shipping"===e.order.delivery_type&&"room"===e.order.delivery_office_or_room?r("q-input",{attrs:{label:"Код домофона",outlined:"",dense:""},model:{value:e.order.delivery_room_key_code,callback:function(t){e.$set(e.order,"delivery_room_key_code",t)},expression:"order.delivery_room_key_code"}}):e._e(),"shipping"===e.order.delivery_type?r("q-toggle",{staticClass:"q-mb-sm",attrs:{label:"Доставить ко времени","true-value":"time_to","false-value":"now"},model:{value:e.order.delivery_time_check,callback:function(t){e.$set(e.order,"delivery_time_check",t)},expression:"order.delivery_time_check"}}):e._e(),"shipping"===e.order.delivery_type&&"time_to"===e.order.delivery_time_check?r("q-input",{attrs:{label:"Укажите удобное время *",outlined:"",mask:"time",rules:["time"]},scopedSlots:e._u([{key:"append",fn:function(){return[r("q-icon",{staticClass:"cursor-pointer",attrs:{name:"access_time"}},[r("q-popup-proxy",{attrs:{"transition-show":"fade","transition-hide":"fade"}},[r("q-time",{attrs:{options:e.deliveryTimeOptionsFn},model:{value:e.order.delivery_time,callback:function(t){e.$set(e.order,"delivery_time",t)},expression:"order.delivery_time"}})],1)],1)]},proxy:!0}],null,!1,1917406988),model:{value:e.order.delivery_time,callback:function(t){e.$set(e.order,"delivery_time",t)},expression:"order.delivery_time"}}):e._e(),r("q-item-label",[e._v("Как Вам будет удобно оплатить?")]),r("q-item",{staticClass:"q-px-none"},[r("q-item-section",[r("q-option-group",{attrs:{options:e.paymentOptions,color:"primary"},model:{value:e.order.payment_type,callback:function(t){e.$set(e.order,"payment_type",t)},expression:"order.payment_type"}})],1)],1),r("transition",{attrs:{appear:"","enter-active-class":"animated fadeIn","leave-active-class":"animated fadeOut"}},["money"===e.order.payment_type?r("q-input",{staticClass:"q-mb-lg",attrs:{label:"Сдача с",outlined:"",dense:"",suffix:"= "+e.moneyDiffCalc},model:{value:e.order.money_diff,callback:function(t){e.$set(e.order,"money_diff",t)},expression:"order.money_diff"}}):e._e()],1),r("q-input",{staticClass:"q-mb-sm",attrs:{label:"Комментарий",outlined:"",dense:"",autogrow:""},model:{value:e.order.comment,callback:function(t){e.$set(e.order,"comment",t)},expression:"order.comment"}}),r("q-toggle",{staticClass:"q-mb-sm",attrs:{label:"Я согласен(а) на обработку моих персональных данных *"},model:{value:e.order.agree_terms,callback:function(t){e.$set(e.order,"agree_terms",t)},expression:"order.agree_terms"}})],1)],1)],1)],1),r("q-page-sticky",{staticClass:"bg-grey-3",attrs:{expand:"",position:"bottom"}},[r("q-item",{staticStyle:{width:"100%"}},[r("q-item-section",[r("q-list",{staticClass:"cart-total-prices",attrs:{dense:""}},[r("q-item",[r("q-item-section",[e._v("Стоимость:")]),r("q-item-section",{staticClass:"text-weight-bolder text-grey-9",attrs:{side:""}},[e._v("\n              "+e._s(e._f("price_format")(e.cart.total_sum))+"\n            ")])],1),r("q-item",[r("q-item-section",[e._v("Доставка:")]),r("q-item-section",{staticClass:"text-weight-bolder text-grey-9",attrs:{side:""}},[e.loadingDeliveryPrice?[r("q-spinner-dots",{attrs:{color:"primary",size:"2em"}})]:null===e.order.delivery_cost?[e._v("\n                не рассчитано\n              ")]:[e._v("\n                "+e._s(e._f("price_format")(e.order.delivery_cost))+"\n              ")]],2)],1),e.deliveryCostError?r("q-item",{staticClass:"text-caption text-red"},[e._v(e._s(e.deliveryCostError))]):e._e(),e.minOrderPriceError?r("q-item",{staticClass:"text-caption text-red"},[e._v(e._s(e.minOrderPriceError))]):e._e(),r("q-item",[r("q-item-section",[e._v("Итого:")]),r("q-item-section",{staticClass:"text-weight-bolder text-grey-9",attrs:{side:""}},[e.totalSum?[e._v("\n                "+e._s(e._f("price_format")(e.totalSum))+"\n              ")]:[e._v("не рассчитано")]],2)],1)],1)],1),r("q-item-section",{attrs:{side:""}},[r("q-btn",{attrs:{unelevated:"",color:"primary",disabled:!e.totalSum||e.checking_out,loading:e.checking_out},on:{click:e.createOrder}},[e._v("\n          Оформить\n        ")])],1)],1)],1)],1)},n=[],o=(r("8e6e"),r("8a81"),r("456d"),r("c5f6"),r("f751"),r("967e")),a=r.n(o),s=(r("96cf"),r("fa84")),l=r.n(s),c=(r("7514"),r("7f7f"),r("ac6a"),r("cadf"),r("06db"),r("4db1")),d=r.n(c),u=r("c47a"),m=r.n(u),p=r("2f62"),f=r("1c16"),y=r("bd4c"),_=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("q-select",{ref:"select",attrs:{label:e.label||"",outlined:"",value:e.street,"use-input":"",dense:"",loading:e.loading,options:e.options,"option-label":"value","option-value":"data","options-dense":"",hint:"Вводите для поиска улицы",clearable:"","clear-icon":"close",rules:e.rules},on:{"input-value":e.onInputValue,input:e.onInput},scopedSlots:e._u([{key:"no-option",fn:function(){return[r("q-item",[r("q-item-section",{staticClass:"text-grey"},[e._v("\n        Совпадение не найдено\n      ")])],1)]},proxy:!0}])})},v=[];function b(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,i)}return r}function h(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?b(Object(r),!0).forEach((function(t){m()(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):b(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var g={name:"KlStreetSelect",props:["city","rules","label"],data:function(){return{loading:!1,street:null,options:[]}},watch:{city:function(e,t){void 0!==t&&(this.street=null,this.$emit("input",null),this.options=[])}},methods:h(h({},Object(p["b"])("cart",["getStreetSuggestions"])),{},{onInputValue:function(e){e&&this.debounceSearchOptions(e)},searchOptions:function(e){var t=this;return l()(a.a.mark((function r(){var i,n;return a.a.wrap((function(r){while(1)switch(r.prev=r.next){case 0:if(t.options=[],t.city){r.next=4;break}return console.warn("Необходимо выбрать Город для поиска совпадений по улице"),r.abrupt("return");case 4:return t.loading=!0,i={search:e,city:t.city.city_id_external},r.prev=6,r.next=9,t.getStreetSuggestions(i);case 9:n=r.sent,t.options=n.suggestions,t.$refs.select.refresh(),t.$refs.select.showPopup(),r.next=18;break;case 15:r.prev=15,r.t0=r["catch"](6),console.error(r.t0);case 18:return r.prev=18,t.loading=!1,r.finish(18);case 21:case"end":return r.stop()}}),r,null,[[6,15,18,21]])})))()},onInput:function(e){this.street=e,this.$emit("input",e.data)}}),created:function(){this.debounceSearchOptions=Object(f["a"])(this.searchOptions,500)}},q=g,k=r("2877"),C=r("eebe"),O=r.n(C),x=r("ddd8"),w=r("66e5"),S=r("4074"),j=Object(k["a"])(q,_,v,!1,null,"2304500e",null),D=j.exports;O()(j,"components",{QSelect:x["a"],QItem:w["a"],QItemSection:S["a"]});var P=r("4cfa"),I=r("f876");function Q(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,i)}return r}function $(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Q(Object(r),!0).forEach((function(t){m()(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Q(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var E={name:"Cart",components:{KlStreetSelect:D,ValidationErrors:I["a"]},data:function(){return{loadingDeliveryPrice:!1,updatingQuantity:!1,checking_out:!1,loading:!1,deleting:!1,deliveryCity:null,deliveryStreet:{},deliveryBuilding:null,deliveryCostCalcComment:"",deliveryCostError:null,minOrderPriceError:null,order:{delivery_type:"shipping",created:!1,number:"",dateCreated:"",comment:"",payment_type:"money",money_diff:null,delivery_office_or_room:"office",delivery_office_firm_name:"",delivery_office_floor:null,delivery_office_number:null,delivery_room_number:null,delivery_room_entrance:null,delivery_room_floor:null,delivery_room_key_code:"",delivery_time_check:"now",delivery_time:this.getInitialDeliveryTime(),delivery_cost:null,agree_terms:!1},emptyOrder:{delivery_type:"shipping",created:!1,number:"",dateCreated:"",comment:"",payment_type:"money",money_diff:null,delivery_office_or_room:"office",delivery_office_firm_name:"",delivery_office_floor:null,delivery_office_number:null,delivery_room_number:null,delivery_room_entrance:null,delivery_room_floor:null,delivery_room_key_code:"",delivery_time_check:"now",delivery_time:this.getInitialDeliveryTime(),delivery_cost:null,agree_terms:!1},cities:[],paymentOptions:[{label:"Наличными",value:"money"},{label:"Банковской картой при получении",value:"bank_card_receipt"}],createdOrderData:{},markedForSet:[]}},watch:{"order.delivery_type":function(e,t){this.order.delivery_cost="pickup"===e?0:null,this.order.delivery_office_or_room="pickup"===e?null:"office",this.order.delivery_time="pickup"===e?null:this.getInitialDeliveryTime(),this.$refs.form.resetValidation()},"order.delivery_office_or_room":function(e,t){this.$refs.form.resetValidation()},"order.delivery_time_check":function(e,t){void 0!==t&&(this.order.delivery_time=this.getInitialDeliveryTime())},deliveryCity:function(e,t){void 0!==t&&(this.deliveryBuilding=null)},deliveryStreet:function(e,t){e&&this.calcDeliveryPriceAndOrderMinPrice()},deliveryBuilding:function(e,t){e&&this.calcDeliveryPriceAndOrderMinPrice()},markedForSet:function(e,t){this.createSetIfPossible()}},computed:$($($($({},Object(p["c"])("cart",["cart","cartStandaloneItems","sets"])),Object(p["c"])("auth",["user","user_main_phone"])),Object(p["c"])(["hasErrors"])),{},{totalSum:function(){return!this.cart.total_sum||null===this.order.delivery_cost&&"shipping"===this.order.delivery_type?null:this.cart.total_sum+this.order.delivery_cost},quantityItems:function(){return d()(Array(1e3).keys()).slice(1)},deliveryAddress:function(){if(!this.deliveryCity||!this.deliveryStreet||!this.deliveryBuilding)return"";var e=this.deliveryStreet.settlement_with_type?"".concat(this.deliveryStreet.settlement_with_type," "):"",t="улица"===this.deliveryStreet.street_type_full?this.deliveryStreet.street:this.deliveryStreet.street_with_type||"";return"город:".concat(this.deliveryCity.name,", улица:").concat(e).concat(t,", дом:").concat(this.deliveryBuilding)},moneyDiffCalc:function(){return this.order.money_diff&&this.totalSum?parseInt(this.order.money_diff)-parseInt(this.totalSum):0},showCombineToComplectHeader:function(){if(0===this.cartStandaloneItems.length)return!1;var e=this.cartStandaloneItems.filter((function(e){return!0===e.for_complect}));if(!e||e.length<2)return!1;var t=e.find((function(e){return"Гарниры"===e.category.title&&1===e.quantity})),r=e.find((function(e){return"Мясные блюда"===e.category.title&&1===e.quantity}));return!!t&&!!r}}),methods:$($({},Object(p["b"])("cart",["getCart","updateQuantity","checkout","getDeliveryCost","clearCart","createSet","deleteItem"])),{},{deleteCartItem:function(e){var t=this;return l()(a.a.mark((function r(){return a.a.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return t.deleting=!0,r.prev=1,r.next=4,t.deleteItem(e.id);case 4:return r.prev=4,t.deleting=!1,r.finish(4);case 7:case"end":return r.stop()}}),r,null,[[1,,4,7]])})))()},updateCartItemQuantity:function(e,t){var r=this;return l()(a.a.mark((function i(){return a.a.wrap((function(i){while(1)switch(i.prev=i.next){case 0:return r.updatingQuantity=!0,i.prev=1,i.next=4,r.updateQuantity({id:e,quantity:t});case 4:return i.prev=4,r.updatingQuantity=!1,i.finish(4);case 7:case"end":return i.stop()}}),i,null,[[1,,4,7]])})))()},calcDeliveryPriceAndOrderMinPrice:function(){var e=this;return l()(a.a.mark((function t(){var r,i;return a.a.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(e.deliveryCity&&e.deliveryStreet&&e.deliveryBuilding){t.next=3;break}return e.deliveryCostError="Укажите адрес доставки полностью!",t.abrupt("return");case 3:return e.deliveryCostError=null,e.minOrderPriceError=null,r={destination:e.deliveryAddress,cartTotalPrice:e.cart.total_sum},t.prev=6,e.loadingDeliveryPrice=!0,t.next=10,e.getDeliveryCost(r);case 10:i=t.sent,e.order.delivery_cost=i.cost,console.info("Расстояние до клиента: "+i.distance.text),t.next=18;break;case 15:t.prev=15,t.t0=t["catch"](6),t.t0.response&&t.t0.response.data.min_order_price_warning?e.minOrderPriceError=t.t0.response.data.min_order_price_warning:(e.deliveryCostCalcComment="Стоимость доставки не была рассчитана!",console.error("Возникла ошибка расчета расстояния до выбранного адреса: "+t.t0.response.data.warning));case 18:return t.prev=18,e.loadingDeliveryPrice=!1,t.finish(18);case 21:case"end":return t.stop()}}),t,null,[[6,15,18,21]])})))()},createOrder:function(){var e=this;this.$refs.form.validate().then(function(){var t=l()(a.a.mark((function t(r){var i;return a.a.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(r){t.next=5;break}return Object(P["a"])("Проверьте заполнение необходимых полей для заказа"),t.abrupt("return",!1);case 5:if(!1!==e.order.agree_terms){t.next=8;break}return Object(P["a"])("Необходимо дать согласие на обработку персональных данных"),t.abrupt("return");case 8:return i=Object.assign({},e.order,{customer_phone:e.user_main_phone.number,customer_name:e.user.name,delivery_address:e.deliveryAddress,order_comment:e.order.comment,delivery_time:"time_to"===e.order.delivery_time_check?e.order.delivery_time:null}),e.deliveryCostCalcComment.length>0&&(i.order_comment+=" ".concat(e.deliveryCostCalcComment)),t.prev=10,e.checking_out=!0,t.next=14,e.checkout(i);case 14:e.createdOrderData=t.sent,e.notifyOrderCreated(),e.clearCartData();case 17:return t.prev=17,e.checking_out=!1,t.finish(17);case 20:case"end":return t.stop()}}),t,null,[[10,,17,20]])})));return function(e){return t.apply(this,arguments)}}())},getCities:function(){var e=this;return l()(a.a.mark((function t(){var r;return a.a.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,e.$axios.get("/api/cities");case 3:r=t.sent,e.cities=r.data,t.next=10;break;case 7:t.prev=7,t.t0=t["catch"](0),console.error("Ошибка "+t.t0.message);case 10:case"end":return t.stop()}}),t,null,[[0,7]])})))()},getInitialDeliveryTime:function(){var e=new Date;return e=y["b"].addToDate(e,{minutes:40}),y["b"].formatDate(e,"HH:mm")},deliveryTimeOptionsFn:function(e,t,r){var i=new Date;return i=y["b"].addToDate(i,{minutes:40}),!(e&&!this.deliveryTimeHourIsOk(e,i))&&(!(t&&!this.deliveryTimeMinutesIsOk(t,i))&&!r)},deliveryTimeHourIsOk:function(e,t){var r=Number(y["b"].formatDate(t,"HH"));return e>=9&&e<24&&e>=r},deliveryTimeMinutesIsOk:function(e,t){var r=Number(y["b"].formatDate(t,"HH")),i=Number(y["b"].formatDate(t,"mm")),n=Number(y["b"].formatDate(y["b"].extractDate(this.order.delivery_time,"HH:mm"),"HH"));return(n>r||n===r&&i<e)&&e<60&&e%10===0},notifyOrderCreated:function(){var e="Ваш заказ успешно создан.";if(this.createdOrderData&&this.createdOrderData.order_num){var t=y["b"].formatDate(y["b"].extractDate(this.createdOrderData.order_date,"YYYY-MM-DD HH:mm:ss"),"DD-MM-YYYY HH:mm:ss");e="Ваш заказ №".concat(this.createdOrderData.order_num," от ").concat(t," успешно создан.")}this.$q.notify({message:e,type:"positive",position:"center",timeout:1e4,actions:[{icon:"close",color:"white"}]})},markForSet:function(e,t){if(e)this.markedForSet.push(t);else{var r=this.markedForSet.indexOf(t);r>=0&&this.markedForSet.splice(r,1)}},clearCartData:function(){this.clearCart(),this.deliveryCity=null,this.deliveryStreet=null,this.deliveryBuilding=null,this.deliveryCostCalcComment="",this.deliveryCostError=null,this.minOrderPriceError=null,this.order=Object.assign({},this.emptyOrder)},updateCartInfo:function(){var e=this;return l()(a.a.mark((function t(){return a.a.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(!e.loading){t.next=2;break}return t.abrupt("return");case 2:return t.prev=2,e.loading=!0,t.next=6,e.getCart();case 6:return t.prev=6,e.loading=!1,t.finish(6);case 9:case"end":return t.stop()}}),t,null,[[2,,6,9]])})))()},createSetIfPossible:function(){var e=this;return l()(a.a.mark((function t(){var r,i,n;return a.a.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(!(e.markedForSet.length<2)){t.next=2;break}return t.abrupt("return");case 2:if(r=e.markedForSet.find((function(e){return!0===e.for_complect&&"Гарниры"===e.category.title})),i=e.markedForSet.find((function(e){return!0===e.for_complect&&"Мясные блюда"===e.category.title})),r&&i){t.next=5;break}return t.abrupt("return");case 5:return n=e.markedForSet.map((function(e){return{id:e.id,dish_id:e.dish_id,price:e.price}})),t.prev=6,e.loading=!0,t.next=10,e.createSet(n);case 10:return t.prev=10,e.loading=!1,t.finish(10);case 13:e.markedForSet=[];case 14:case"end":return t.stop()}}),t,null,[[6,,10,13]])})))()}}),mounted:function(){this.updateCartInfo()},created:function(){this.updateCartItemQuantity=Object(f["a"])(this.updateCartItemQuantity,1e3),this.getCities()}},T=E,H=(r("554a"),r("9989")),F=r("1c1c"),B=r("3b73"),M=r("f09f"),Y=r("a370"),A=r("8380"),V=r("0170"),z=r("9c40"),L=r("eb85"),N=r("0016"),J=r("2c91"),K=r("8f8e"),G=r("0378"),R=r("9564"),U=r("27f9"),W=r("6a67"),X=r("7cbe"),Z=r("ca78"),ee=r("9f0a"),te=r("de5e"),re=Object(k["a"])(T,i,n,!1,null,null,null);t["default"]=re.exports;O()(re,"components",{QPage:H["a"],QItem:w["a"],QList:F["a"],QExpansionItem:B["a"],QCard:M["a"],QCardSection:Y["a"],QSpinnerDots:A["a"],QItemLabel:V["a"],QItemSection:S["a"],QBtn:z["a"],QSelect:x["a"],QSeparator:L["a"],QIcon:N["a"],QSpace:J["a"],QCheckbox:K["a"],QForm:G["a"],QToggle:R["a"],QInput:U["a"],QBtnToggle:W["a"],QPopupProxy:X["a"],QTime:Z["a"],QOptionGroup:ee["a"],QPageSticky:te["a"]})},f876:function(e,t,r){"use strict";var i=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"q-px-none q-py-md"},[r("q-list",{staticClass:"bg-red-1",attrs:{dense:"",padding:""}},e._l(e.errors,(function(t,i){return r("q-item",{key:i,staticClass:"text-red"},[r("q-item-section",[e._v("\n        "+e._s(t)+"\n      ")])],1)})),1)],1)},n=[],o=(r("8e6e"),r("8a81"),r("ac6a"),r("cadf"),r("06db"),r("456d"),r("c47a")),a=r.n(o),s=r("2f62");function l(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,i)}return r}function c(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?l(Object(r),!0).forEach((function(t){a()(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):l(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var d={name:"ValidationErrors",data:function(){return{dialog:!1}},computed:c({},Object(s["c"])(["errors"])),methods:c(c({},Object(s["b"])(["clearErrors"])),{},{close:function(){this.clearErrors()}})},u=d,m=r("2877"),p=r("eebe"),f=r.n(p),y=r("1c1c"),_=r("66e5"),v=r("4074"),b=Object(m["a"])(u,i,n,!1,null,null,null);t["a"]=b.exports;f()(b,"components",{QList:y["a"],QItem:_["a"],QItemSection:v["a"]})}}]);